<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title> Select Multi-Opions Experiment </title>

        <script src="jspsych/jspsych.js"></script>
        <script src="jspsych/plugin-html-button-response.js"></script>
        <script src="jspsych/plugin-instructions.js"></script>
        <script src="jspsych/plugin-image-keyboard-response.js"></script>
        <script src="jspsych/plugin-html-keyboard-response.js"></script>
        <script src="jspsych/plugin-preload.js"></script>

        <script src="plugin-multi_select/plugin-select-multiple-buttons.js"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/6.2.1/math.js"></script>

        <link href="css/jspsych.css" rel="stylesheet" type="text/css" />

    <style>

    .jspsych-multiple-select-response-button {
        float: center;
        border: 4px
        solid #FFFFFF;
        cursor: pointer;
        width: 130px;
        padding: 1px;
        margin-bottom: 10px;
        }
    .active {
        border: 4px
        solid #FFFF00;
        background: #eeeeee;
        }
        /* Clear floats after image containers */
    .jspsych-multiple-select-response-button::after {
        content: "";
        clear: both;
        display: table;
    }
    </style>

    </head>

    <body>
    </body>

<script>
    var jsPsych = initJsPsych({
        on_finish: function () {
                jsPsych.data.displayData()
            }
    }
);

//Creating list of image paths to load.
//These are image paths to images for the experimental treatment shown on each trial
var image_indices_lst = math.range(1, 80); //math.range() returns a js obj that has a parameter called '._data' and that has an Array of the range.

image_indices_lst = Array.from(image_indices_lst._data); // This is just a list containing the range of numbers used for each url of the
// experimental stimulus. The experimental stimuli are all saved in the /img/food/ folder. They have a prefix "food"
// and then they include the number 1-N for N number of trials.
var arrayLength = image_indices_lst.length; // arrayLength is used to show how many images/trials there are from 1-N trials.
var image_paths = [];
for (var i = 0; i < arrayLength; i++) {
    // This for loop fills the image_paths list with urls to the images for each of the experimental treatments
    var path_str1 = "img/food/food" + String(image_indices_lst[i]) + ".jpg";
    image_paths.push(path_str1);
  }

// Preloading files are needed to present the stimuli accurately.
const preload = {
    type: jsPsychPreload,
    images: image_paths,
}
const shuffled_image_names = jsPsych.randomization.shuffle(image_paths);
const trial_options = shuffled_image_names.slice(0, 15);
    var factors = {
            image: shuffled_image_names,
    };

        var factorial_values = jsPsych.randomization.factorial(factors);

        var fixation = {
            data: {screen_id: "fixation"},
            type: jsPsychHtmlKeyboardResponse,
            stimulus: "<div style='font-size: 60px'>+</div>",
            trial_duration: [500],
            response_ends_trial: false
        };
        var trial = {
            data: {
                screen_id: "trial",
                options: trial_options
            },
            type: jsPsychMutipleButtonResponse,
            stimulus: [],
            prompt: [],
            choices: [shuffled_image_names[0],
                    shuffled_image_names[1],
                    shuffled_image_names[2],
                    shuffled_image_names[3],
                    shuffled_image_names[4],
                    shuffled_image_names[5],
                    shuffled_image_names[6],
                    shuffled_image_names[7],
                    shuffled_image_names[8],
                    shuffled_image_names[9],
                    shuffled_image_names[10],
                    shuffled_image_names[11],
                    shuffled_image_names[12],
                    shuffled_image_names[13],
                    shuffled_image_names[14]
                ],
                    button_html: [
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-0">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-1">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-2">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-3">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-4">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-5">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-6">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-7">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-8">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-9">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-10">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-11">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-12">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-13">',
                        '<img src="%choice%" style="width:128px;height:128px;display:table;", id="jspsych-html-button-response-button-14">'                    ],
                    response_ends_trial: true,
                    keys: ' ',
                    margin_vertical: "40px",
                    margin_horizontal: "50px"
                };

        var trials_with_variables = {
            timeline: [preload, fixation, trial],
            // timeline_variables: factorial_values
        };

        // Debrief

        // timeline
        var timeline = []

        timeline.push(trials_with_variables);

        //Start Experiment
        jsPsych.run(timeline);

</script>
</html>
